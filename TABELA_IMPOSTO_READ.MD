# ğŸ“˜ README â€“ Como preparar e importar uma planilha do Excel para o MySQL (passo a passo completo)

Este guia explica, de forma simples e prÃ¡tica, como transformar uma planilha do Excel em uma tabela limpa e correta no MySQL.  
Inclui erros comuns, como fÃ³rmulas, vÃ­rgulas, cifrÃ£o, tipos de dados incorretos e problemas de codificaÃ§Ã£o.

---

## ğŸ“Œ 1. Objetivo

Ensinar como:

- preparar uma planilha do Excel para importaÃ§Ã£o  
- evitar erros comuns (fÃ³rmulas, vÃ­rgulas, R$, formataÃ§Ã£o)  
- escolher os tipos corretos no MySQL  
- importar o arquivo com seguranÃ§a  
- entender por que alguns tipos foram trocados  

Este guia serve para qualquer pessoa, mesmo sem experiÃªncia.

---

## ğŸ“Œ 2. Problemas encontrados inicialmente

Ao tentar subir a planilha diretamente para o MySQL, surgiram vÃ¡rios erros:

### âŒ FÃ³rmulas do Excel  
O MySQL nÃ£o entende nada como:

```
=SE()
=SOMA()
=A1+B1
```

Quando importado, isso vira texto invÃ¡lido.

---

### âŒ FormataÃ§Ã£o condicional  
Cores, Ã­cones, negrito, filtrosâ€¦ nada disso Ã© importado.  
Mas Ã s vezes atrapalha porque esconde dados ou cria confusÃ£o.

---

### âŒ SÃ­mbolo â€œR$â€  
O MySQL nÃ£o aceita valores como:

```
R$ 3.922,00
```

Isso vira texto e impede cÃ¡lculos.

---

### âŒ VÃ­rgula como separador decimal  
Excel brasileiro usa vÃ­rgula:

```
3770,35
```

MySQL usa ponto:

```
3770.35
```

Se nÃ£o converter, o MySQL trata como texto.

---

### âŒ Tipos de dados errados  
- Dinheiro estava como **DOUBLE** â†’ impreciso  
- Percentual estava como **DOUBLE** â†’ tambÃ©m impreciso  
- Alguns valores poderiam virar **INT** â†’ perderiam casas decimais  

---

## ğŸ“Œ 3. Como preparar a planilha no Excel

### âœ”ï¸ 3.1. Transformar fÃ³rmulas em valores

1. Selecione a coluna com fÃ³rmulas  
2. Copiar  
3. Colar especial â†’ **Valores**

Assim, o MySQL recebe apenas o nÃºmero final.

---

### âœ”ï¸ 3.2. Remover sÃ­mbolos e formataÃ§Ã£o

- Apagar â€œR$â€  
- Remover espaÃ§os extras  
- Garantir que nÃ£o hÃ¡ cÃ©lulas mescladas  
- Conferir se nÃ£o hÃ¡ linhas ocultas  

---

### âœ”ï¸ 3.3. Trocar vÃ­rgula por ponto

No Excel:

1. CTRL+L (Localizar e substituir)  
2. Localizar: `,`  
3. Substituir por: `.`  

Agora os nÃºmeros ficam no padrÃ£o do MySQL.

---

### âœ”ï¸ 3.4. Salvar como CSV UTFâ€‘8

Esse Ã© o formato ideal porque:

- nÃ£o leva fÃ³rmulas  
- nÃ£o leva formataÃ§Ã£o  
- Ã© leve  
- Ã© compatÃ­vel com MySQL  

---

## ğŸ“Œ 4. Criando a tabela no MySQL com tipos corretos

### â— Por que nÃ£o usar INT para dinheiro?

Porque INT nÃ£o aceita casas decimais.  
VocÃª perderia valores como:

```
3770.35 â†’ 3770
6.39 â†’ 6
```

---

### â— Por que nÃ£o usar DOUBLE?

DOUBLE Ã© um tipo **aproximado**, nÃ£o exato.  
Pode gerar valores como:

```
10.99 â†’ 10.98999999997
```

Isso Ã© pÃ©ssimo para cÃ¡lculos financeiros.

---

### âœ”ï¸ Tipo correto para dinheiro

```
DECIMAL(10,2)
```

Exato, seguro e ideal para valores monetÃ¡rios.

---

### âœ”ï¸ Tipo correto para percentuais

```
DECIMAL(5,2)
```

Perfeito para valores como:

```
10.99
22.77
6.03
```

---

### âœ”ï¸ Exemplo de criaÃ§Ã£o da tabela

```sql
CREATE TABLE contribuintes (
    id INT PRIMARY KEY,
    renda_anual DECIMAL(10,2),
    categoria VARCHAR(20),
    percentual_imposto DECIMAL(5,2)
);
```

---

## ğŸ“Œ 5. Ajustando tipos depois de criar errado

Se vocÃª criou como DOUBLE e quer corrigir:

```sql
ALTER TABLE contribuintes
MODIFY renda_anual DECIMAL(10,2);

ALTER TABLE contribuintes
MODIFY percentual_imposto DECIMAL(5,2);
```

---

## ğŸ“Œ 6. Importando o CSV no MySQL

VocÃª pode usar:

### âœ”ï¸ MySQL Workbench (import wizard)  
ou  
### âœ”ï¸ Comando SQL:

```sql
LOAD DATA INFILE 'caminho/arquivo.csv'
INTO TABLE contribuintes
FIELDS TERMINATED BY ','
ENCLOSED BY '\''
LINES TERMINATED BY '\n'
IGNORE 0 LINES
(id, renda_anual, categoria, percentual_imposto);
```

---

## ğŸ“Œ 7. Sobre valores sem â€œ.00â€

No CSV, vocÃª pode ter:

```
3922
3770.35
```

Isso **nÃ£o Ã© problema**.

Se a coluna for `DECIMAL(10,2)`, o MySQL automaticamente converte:

- `3922` â†’ `3922.00`  
- `3770.35` â†’ permanece igual  

---

## ğŸ“Œ 8. Fluxo final recomendado (resumo rÃ¡pido)

### **No Excel**
1. Transformar fÃ³rmulas em valores  
2. Remover â€œR$â€  
3. Trocar vÃ­rgula por ponto  
4. Conferir datas e nÃºmeros  
5. Salvar como CSV UTFâ€‘8  

### **No MySQL**
1. Criar tabela com tipos corretos  
2. Importar CSV  
3. Validar com `SELECT * FROM tabela;`  

---

## ğŸ“Œ 9. Resultado final

Depois de seguir esse processo:

- os dados sobem limpos  
- sem erros de fÃ³rmula  
- sem problemas de vÃ­rgula  
- sem perda de casas decimais  
- com tipos corretos para cÃ¡lculos  
- e prontos para anÃ¡lises SQL  


